# üõ†Ô∏è VitalTrack Mobile: Setup, Installation & Challenges Guide

This document is a comprehensive guide for developers setting up the **VitalTrack Mobile** project. It details the exact versions used, the installation process, and specific technical challenges encountered (and solved) during development.

---

## üìã 1. Environment & Versions

To ensure a smooth setup, match these versions as closely as possible.

### Core Tech Stack
*   **Node.js**: `v18.x` or `v20.x` (Recommended)
*   **Package Manager**: `npm` (v9+) or `yarn` (v1.22+)
*   **Expo SDK**: `52` / `54` (Project uses `~54.0.31`)
*   **React Native**: `0.81.5`
*   **React**: `19.1.0`

### Key Dependencies (from `package.json`)
| Package | Version | Purpose |
| :--- | :--- | :--- |
| `expo-router` | `~6.0.21` | File-based routing (app directory) |
| `expo-print` | `~15.0.8` | Generating PDF documents |
| `expo-sharing` | `~14.0.8` | Sharing PDFs/Files |
| `expo-file-system` | `~19.0.21` | Handling local files/images |
| `expo-image-picker` | `~17.0.10` | Selecting images from gallery |
| `zustand` | `^4.5.2` | State management (lighter than Redux) |
| `date-fns` | `^3.6.0` | Date formatting |

---

## üöÄ 2. Installation Guide (From Scratch)

### Step 1: Clone & Install
```bash
# 1. Clone the repository
git clone https://github.com/rishabhrd09/vitaltrack-mobile.git

# 2. Navigate to directory
cd vitaltrack-mobile

# 3. Install dependencies (Legacy peer deps flag helps with some Expo version mismatches if they occur)
npm install --legacy-peer-deps
# OR use Expo's aligned installer
npx expo install
```

### Step 2: Setup Expo Go (Mobile)
1.  Download **Expo Go** from Google Play Store (Android) or App Store (iOS).
2.  Connect your phone to the **same Wi-Fi** as your computer.

### Step 3: Run the App
```bash
# Start the development server
npx expo start --clear

# The --clear flag is important to reset the Metro bundler cache if you switch branches or update packages.
```
*   **Android**: Scan QR code with Expo Go.
*   **iOS**: Scan QR code with Camera app.

---

## üß† 3. Challenges & Transformations (Knowledge Base)

This section maps out the hurdles we faced so you don't have to re-solve them.

### üî¥ Challenge 1: PDF Image Embedding (The "Black Box" Issue)
*   **Problem**: When generating PDFs (`expo-print`), images passed as `file://` URIs would often fail to render or show as broken links in the PDF preview.
*   **Root Cause**: `expo-print` (embedded WebView) sometimes cannot access local `file://` paths directly due to permission sandboxing, especially on newer Android versions.
*   **Solution**:
    1.  Convert the image to **Base64** string before passing to HTML.
    2.  Use `expo-file-system` to read the file.
    3.  **Crucial Version Note (Expo 54+)**: The standard `FileSystem.readAsStringAsync` showed deprecation warnings.
    4.  **Fix**: Import from legacy: `import { readAsStringAsync } from 'expo-file-system/legacy';`.

### üî¥ Challenge 2: "ReferenceError: Property 'FileSystem' doesn't exist"
*   **Problem**: After fixing the import, the app crashed with this error during PDF export.
*   **Cause**: We used `import * as FileSystem` but tried to call a named export on a potentially undefined module object in the transpiled code.
*   **Solution**: Switched to **named import** specifically:
    ```typescript
    import { readAsStringAsync } from 'expo-file-system/legacy';
    // Usage:
    await readAsStringAsync(uri, { encoding: 'base64' });
    ```
    This resolved the runtime crash immediately.

### üî¥ Challenge 3: PDF Layouts (Grid vs Table)
*   **Problem**: User needed two distinct formats: one for visual verification (Images) and one for bulk ordering (Compact Table).
*   **Solution**:
    *   **Table Layout**: Pure HTML `<table>` with specific CSS for borders and blue headers. Images strictly removed.
    *   **Card Layout**: A specialized CSS Grid layout.
        *   *Evolution*: Started as vertical stack -> Horizontal row -> **60/40 Split Ratio**.
        *   Left 60%: Details in a "2x2 Quadrant" (Order, Brand, Supplier, Link).
        *   Right 40%: Dedicated Image container with `object-fit: contain` to prevent cropping.

### üî¥ Challenge 4: Expo Router Tab Bar Spacing
*   **Problem**: The bottom tab bar items were squashed against the screen edge on some devices.
*   **Solution**: Adjusted `app/(tabs)/_layout.tsx` to increase `height` to `70` and `paddingBottom` to `12`.

---
*Guide generated by VitalTrack Dev Team - Jan 2026*
